/*! @name videojs-yt-style @version 0.1.10 @license UNLICENSED */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("video.js"),require("global/document"),require("global/window")):"function"==typeof define&&define.amd?define(["video.js","global/document","global/window"],t):(e="undefined"!=typeof globalThis?globalThis:e||self).videojsYtStyle=t(e.videojs,e.document,e.window)}(this,(function(e,t,n){"use strict";function r(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var i=r(e),o=r(t),a=r(n);function l(e,t,n){return e(n={path:t,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==t&&n.path)}},n.exports),n.exports}var u=l((function(e){function t(n,r){return e.exports=t=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},e.exports.default=e.exports,e.exports.__esModule=!0,t(n,r)}e.exports=t,e.exports.default=e.exports,e.exports.__esModule=!0})),s=l((function(e){e.exports=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,u(e,t)},e.exports.default=e.exports,e.exports.__esModule=!0})),c=i.default.dom;i.default.getComponent("TimeTooltip").prototype.update=function(e,t,n){var r=c.findPosition(this.el_),i=c.getBoundingClientRect(this.player_.el()),o=e.width*t;if(i&&r){var a=e.left-i.left+o,l=e.width-o+(i.right-e.right);this.options_.playerOptions.keepTimeTooltipInSeekBar&&(l=e.width-o,a=e.width-l);var u=r.width/2;if(this.options_.playerOptions.keepTimeTooltipInSeekBar){var s=e.width/2-o;r.width>e.width?u+=s:a<u?u+=u-a:l<u&&(u-=u-l)}else a<u?u+=u-a:l<u&&(u=l),u<0?u=0:u>r.width&&(u=r.width);u=Math.round(u),this.el_.style.right="-"+u+"px",this.write(n)}};var f=i.default.getComponent("SeekBar");f.prototype.getPercent=function(){var e=this.player_.currentTime()/this.player_.getDuration();return e>=1?1:e},f.prototype.handleMouseMove=function(e){var t=this.player_;if(i.default.dom.isSingleLeftClick(e)){var n=this.calculateDistance(e)*t.getDuration();n===t.getDuration()&&(n-=.1),t.currentTime(n),this.update()}};var d=function(e){function t(t,n){return void 0===n&&(n={}),e.call(this,t,n)||this}return s(t,e),t.prototype.createEl=function(){return i.default.dom.createEl("div",{className:"vjs-progress-bar-padding"})},t}(i.default.getComponent("Component"));i.default.registerComponent("ProgressBarPadding",d);var p=function(e,t){var n,r,i,a=e,l=[],u=!0;a.requestVideoFrameCallback&&a.requestVideoFrameCallback((function e(s,c){var f=Math.abs(c.mediaTime-n)/Math.abs(c.presentedFrames-r);f&&f<1&&u&&l.length<50&&1===a.playbackRate&&o.default.hasFocus()&&(l.push(f),i=Math.round(1/(l.reduce((function(e,t){return e+t}))/l.length)),t({fps:i,certainty:2*l.length})),u=!0,n=c.mediaTime,r=c.presentedFrames,a.requestVideoFrameCallback(e)}));return function(){l.pop(),u=!1}},h=function(e){e.fps_={fps:10,certainty:0},e.fps=function(t){return"number"!=typeof t||(e.fps_.fps=t),e.fps_.fps};var t=e.options_;"number"==typeof t.fps&&t.fps>0?e.fps(t.fps):e.one("loadstart",(function(){var t=e.tech({IWillNotUseThisInPlugins:!0});if(t&&"function"==typeof t.el&&t.el().requestVideoFrameCallback){var n,r,i,o,a=(n=function(t){e.fps(t.fps),e.fps_.certainty=t.certainty,e.trigger("fpsupdate",t)},r=30,function(){var e=this,t=arguments;o?(clearTimeout(i),i=setTimeout((function(){Date.now()-o>=r&&(n.apply(e,t),o=Date.now())}),r-(Date.now()-o))):(n.apply(e,t),o=Date.now())}),l=p(t.el(),a);e.on("seeked",l),e.on("dispose",(function(){e.off("seeked",l)}))}}))},y=l((function(e){function t(){return e.exports=t=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},e.exports.default=e.exports,e.exports.__esModule=!0,t.apply(this,arguments)}e.exports=t,e.exports.default=e.exports,e.exports.__esModule=!0})),v=function(e,t){var n=[e.toLowerCase(),t.toLowerCase()],r=n[0],i=n[1];return r===i||r===i.split("-").at(0)};function g(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return m(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return m(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var x=function(){function e(e,t){var n=this;this.player=e,this.lastShowing_=null;var r=function(){var t=n.active(),r=n.activeTextTrack();n.lastShowing(t),e.trigger("subtitlechange",{index:t,label:r?r.label:""})};e.textTracks().on("change",r),e.on("dispose",(function(){e.textTracks().off("change",r)}))}var t=e.prototype;return t.load=function(e){void 0===e&&(e=[]);var t=this.player;if(e&&e.length){this.removeAll();var n=-1,r=[],i=e.map((function(e,i){var o=y({},e),a=t.addRemoteTextTrack(y({},o,{default:!1}),!0);return a.track.mode="hidden",r.push(a),-1===n&&!0===o.default?n=i:o.default=!1,o}));-1!==n&&(this.flag=i[n].label,this.track=r[n].track,this.track.mode="showing"),t.trigger("subtitles",i)}return this},t.removeAll=function(){var e=this;return this.allTextTracks().forEach((function(t){e.player.removeRemoteTextTrack(t)})),this},t.lastShowing=function(e){return void 0===e&&(e=void 0),"number"!=typeof e||e<0?this.lastShowing_:(this.lastShowing_=e,e)},t.allTextTracks=function(){for(var e,t=[],n=this.player.textTracks(),r=0;r<n.length;r++)"subtitles"===(e=n[r]).kind&&t.push(e);return t},t.default=function(){var e=this.allTextTracks(),t=e.findIndex((function(e){return!0===e.default}));if(-1!==t)return t;var n=e[t];if(n&&v(n.language,a.default.navigator.language))return t;for(var r,i=g(e.entries());!(r=i()).done;)for(var o,l=r.value,u=l[0],s=l[1],c=g(a.default.navigator.languages);!(o=c()).done;){var f=o.value;if(v(s.language,f))return u}return-1},t.getTextTrack=function(e){if(!(e<0)){var t=this.allTextTracks()[e];if(t)return t}},t.active=function(){for(var e,t=-1,n=g(this.allTextTracks().entries());!(e=n()).done;){var r=e.value,i=r[0];if("showing"===r[1].mode){t=i;break}}return t},t.activeTextTrack=function(){return this.getTextTrack(this.active())},t.pick=function(e){if("number"==typeof e){if(e<0)return this.close();var t=this.getTextTrack(e);if(t)return t.mode="showing",t}},t.close=function(){var e=this.activeTextTrack();if(e)return e.mode="disabled",this.lastShowing(e),e},t.quickOpen=function(){var e=this.lastShowing();if("number"==typeof e)return this.pick(e);var t=this.default();return-1!==t?this.pick(t):void 0},e}(),k=function(){function e(e,t){this.values=e.slice(0),this.index_=t||0,this.loop_=!0}var t=e.prototype;return t.index=function(e){if(void 0===e)return this.index_;this.index_=Math.max(0,Math.min(e,this.values.length-1))},t.loop=function(e){if(void 0===e)return this.loop_;this.loop_=!!e},t.calc=function(e){var t=this.index_+e,n=this.values.length;return this.loop_?(n+t)%n:Math.max(0,Math.min(t,n-1))},t.step=function(e){return this.index_=this.calc(e),this.values[this.index_]},t.current=function(){return this.values[this.index_]},t.next=function(){return this.step(1)},t.prev=function(){return this.step(-1)},t.ended=function(){return this.index_===this.values.length-1},e}(),w=function(){function e(e){this.player=e}var t=e.prototype;return t.get=function(){var e=new k(this.player.playbackRates());return e.loop(!1),e.index(this.player.playbackRates().indexOf(this.player.playbackRate())),e},t.next=function(){var e=this.get().next();this.player.playbackRate(e)},t.prev=function(){var e=this.get().prev();this.player.playbackRate(e)},e}(),b=i.default.getComponent("Component"),T=function(e){function t(t,n){return void 0===n&&(n={}),e.call(this,t,n)||this}return s(t,e),t.prototype.createEl=function(){return i.default.dom.createEl("div",{className:"vjs-bezel-text"})},t}(b);i.default.registerComponent("BezelText",T);var _=function(e){function t(t,n){var r;return void 0===n&&(n={}),(r=e.call(this,t,n)||this).addChild("BezelText"),r}return s(t,e),t.prototype.createEl=function(){return i.default.dom.createEl("div",{className:"vjs-bezel-text-wrapper"})},t}(b);i.default.registerComponent("BezelTextWrapper",_);var C=function(e){function t(t,n){var r;return void 0===n&&(n={}),(r=e.call(this,t,n)||this).hideDebounce=function(e,t,n){var r;void 0===n&&(n=!1);var i=!0;return function(){var o=this,a=arguments;i&&n&&(e.apply(o,a),i=!1),clearTimeout(r),r=setTimeout((function(){e.apply(o,a),i=!0}),t)}}(r.hide,500),r.addChild("BezelTextWrapper"),n.text&&r.updateTextContent(n.text),r}s(t,e);var n=t.prototype;return n.createEl=function(){return i.default.dom.createEl("div",{className:"vjs-bezel vjs-hidden"})},n.updateTextContent=function(e){if("string"==typeof e){var t=this.getChild("BezelTextWrapper").getChild("BezelText");i.default.dom.emptyEl(t.el()),i.default.dom.appendContent(t.el(),e)}},n.display=function(e){if("string"==typeof e){var t=e.trim();""!==t&&(this.updateTextContent(t),this.show(),this.hideDebounce())}},t}(b);i.default.registerComponent("Bezel",C);var S="vjs-volume",F=l((function(e){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e},e.exports.default=e.exports,e.exports.__esModule=!0})),B=function(e,t){return function(n,r,i){var o=arguments,a=function(){i.apply(t,o)};n.on(r,a),e.on("dispose",(function(){n.off(r,a)}))}},M=function(e){function t(t,n){var r;void 0===n&&(n={}),(r=e.call(this,t,n)||this).updateButtonState();var i=r.autoEvent=B(t,F(r));return i(t,"enterFullWindow",r.updateButtonState),i(t,"exitFullWindow",r.updateButtonState),r}s(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-fullwindow-control "+e.prototype.buildCSSClass.call(this)},n.handleClick=function(e){this.player_.isFullWindow?this.player_.exitFullWindow():this.player_.enterFullWindow(),this.updateButtonState()},n.updateButtonState=function(){this.player_.isFullWindow?this.controlText("Exit Fullwindow"):this.controlText("Fullwindow")},t}(i.default.getComponent("Button"));i.default.registerComponent("FullwindowToggle",M);var j={customMediaPlayPauseKey:{key:function(e){return"MediaPlayPause"===e.key},handler:function(e,t,n){e.hasStarted()||(e.paused()?e.play():e.pause())}},pauseKey:{key:function(e){return"k"===e.key},handler:function(e,t,n){e.paused()?e.play():e.pause()}},seekStepKey:{key:function(e){return"j"===e.key||"l"===e.key},handler:function(e,t,n){var r=e.currentTime();"j"===n.key?(e.currentTime(Math.max(0,e.currentTime()-10)),r===e.getDuration()&&e.play()):(e.currentTime(Math.min(e.getDuration(),e.currentTime()+10)),r===e.getDuration()&&e.play())}},seekEndKey:{key:function(e){return"Home"===e.key||"End"===e.key},handler:function(e,t,n){"Home"===n.key?(e.currentTime(0),e.play()):(e.currentTime(e.getDuration()),e.play())}},frameKey:{key:function(e){return","===e.key||"."===e.key},handler:function(e,t,n){if(e.paused()){var r=1/e.fps();","===n.key?e.currentTime(Math.max(0,e.currentTime()-r)):e.currentTime(Math.min(e.getDuration(),e.currentTime()+r))}}},speedKey:{key:function(e){return"<"===e.key||">"===e.key},handler:function(e,t,n){"<"===n.key?(e.getChild("Bezel").display(e.playbackRateGoto.get().prev()+"x"),e.playbackRateGoto.prev()):(e.getChild("Bezel").display(e.playbackRateGoto.get().next()+"x"),e.playbackRateGoto.next())}},subtitlesKey:{key:function(e){return"c"===e.key},handler:function(e,t,n){0!==e.subtitles.allTextTracks().length&&(e.subtitles.active()<0?(e.subtitles.quickOpen(),e.getChild("Bezel").display(e.localize(e.subtitles.activeTextTrack().label)+" "+e.localize("Subtitles On"))):(e.subtitles.close(),e.getChild("Bezel").display(""+e.localize("Subtitles Off"))))}},numbersKey:{key:function(e){return e.which>47&&e.which<59||e.which>95&&e.which<106},handler:function(e,t,n){if(t.enableModifiersForNumbers||!(n.metaKey||n.ctrlKey||n.altKey)){var r=48;n.which>95&&(r=96);var i=n.which-r,o=e.currentTime();e.currentTime(e.getDuration()*i*.1),o===e.getDuration()&&e.play()}}}},O=i.default.getPlugin("plugin"),z={},P=function(e){function t(t,n){var r;return(r=e.call(this,t)||this).options=i.default.mergeOptions(z,n),function(e){e.getChild("controlBar").getChild("progressControl").getChild("seekBar").addChild("ProgressBarPadding")}(r.player),function(e){var t=function(){var t=e.currentDimensions(),n=t.width,r=t.height;e.el().style.setProperty("--player-width",n+"px"),e.el().style.setProperty("--player-height",r+"px")};t(),e.on("playerresize",t),e.on("dispose",(function(){e.off("playerresize",t)}))}(r.player),h(r.player),function(e){e.subtitles=new x(e),e.ready((function(){var t=e.options_.subtitles;t&&t.length&&e.subtitles.load(t)}))}(r.player),function(e){e.playbackRateGoto=new w(e)}(r.player),function(e){e.addChild("Bezel",{text:"Loaded"})}(r.player),function(e){var t;try{var n=JSON.parse(a.default.localStorage.getItem(S));t={muted:n.muted,volume:Number(n.volume)/100}}catch(t){e.log.warn(t)}t&&(e.muted(t.muted),e.volume(t.volume));var r=function(){t={muted:e.muted(),volume:Math.round(100*e.volume())};try{Object.keys(t).length?a.default.localStorage.setItem(S,JSON.stringify(t)):a.default.localStorage.removeItem(S)}catch(t){e.log.warn(t)}};e.on("volumechange",r),e.on("dispose",(function(){e.textTracks().off("volumechange",r)}))}(r.player),function(e){e.isOnlyFullWindow=function(){return!(e.fsApi_.requestFullscreen||e.tech_.supportsFullScreen()&&1==!e.options_.preferFullWindow)}}(r.player),function(e){e.exitFullscreenHelper_=function(){if(this.isFullWindow)return this.exitFullWindow();if(this.fsApi_.requestFullscreen){var e=o.default[this.fsApi_.exitFullscreen]();return e&&function(e){return null!=e&&"function"==typeof e.then}(t=e.then((function(){return this.isFullscreen(!1)})))&&t.then(null,(function(e){})),e}var t;this.tech_.supportsFullScreen()&&1==!this.options_.preferFullWindow?this.techCall_("exitFullScreen"):this.exitFullWindow()},e.ready((function(){if(e.options_.alwaysEnableFullWindow&&!e.isOnlyFullWindow()){var t=B(e,e),n=e.getChild("controlBar"),r=n.getChild("FullscreenToggle");n.addChild("FullwindowToggle",{},n.children_.indexOf(r));var i=n.getChild("FullwindowToggle");t(e,"fullscreenchange",(function(){e.isFullscreen()?i.hide():i.show()})),t(e,"enterFullWindow",(function(){i.hide(),r.controlText("Exit Fullwindow")})),t(e,"exitFullWindow",(function(){i.show(),r.controlText("Fullscreen")}))}}))}(r.player),function(e){e.getDuration=function(){return this.liveTracker.isLive()?this.liveTracker.liveCurrentTime():this.duration()}}(r.player),function(e){e.usingPlugin("dashHlsBitrateSwitcher")&&e.one("loadstart",(function(){e.one(i.default.browser.IS_IOS?"canplaythrough":"loadedmetadata",(function(){var t=e.getChild("controlBar").getChild("RatesButton");t&&t.controlText("Bitrate")}))}))}(r.player),function(e){e.hasPlugin("mobileUi")&&!e.usingPlugin("mobileUi")&&e.mobileUi()}(r.player),function(e){var t=e.options_.extraHotkeys,n=j;t&&(n=i.default.mergeOptions(n,t)),e.hasPlugin("hotkeys")&&!e.usingPlugin("hotkeys")&&e.hotkeys({volumeStep:.05,enableMute:!0,enableFullscreen:!0,enableNumbers:!1,enableVolumeScroll:!0,enableHoverScroll:!0,playPauseKey:function(e){return" "===e.key},seekStep:function(e){return e.ctrlKey&&e.shiftKey?300:e.ctrlKey?60:e.altKey?1:5},fullscreenKey:function(e){return"f"===e.key||e.ctrlKey&&"Enter"===e.key},volumeUpKey:function(t){if("ArrowUp"!==t.key)return!1;var n=Math.round(100*Math.min(1,e.volume()+this.volumeStep));return e.getChild("Bezel").display(n+"%"),!0},volumeDownKey:function(t){if("ArrowDown"!==t.key)return!1;var n=Math.round(100*Math.max(0,e.volume()-this.volumeStep));return e.getChild("Bezel").display(n+"%"),!0},muteKey:function(t){if("m"!==t.key)return!1;var n=Math.round(100*e.volume());return e.muted()||(n=0),e.getChild("Bezel").display(n+"%"),!0},customKeys:n})}(r.player),r.player.ready((function(){r.player.addClass("vjs-yt-style")})),r}return s(t,e),t}(O);return P.defaultState={},P.VERSION="0.1.10",i.default.registerPlugin("ytStyle",P),P}));
