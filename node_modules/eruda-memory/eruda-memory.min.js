(function(t,i){if(typeof define==="function"&&define.amd){define([],i)}else if(typeof module==="object"&&module.exports){module.exports=i()}else{t.erudaMemory=i()}})(this,function(){var y=window.innerWidth;return function(t){var r=y,e=192,o=12,l=8,h=12,c=40,d=y-24,f=142,u=2,_="MB";var a=t.util;var s=t.Settings;var v=Math.round;var n=t.Tool;var i=a.evalCss.getCurTheme();var m=i.background;var p=i.accent;var g=n.extend({name:"memory",init:function(t,i){this.callSuper(n,"init",arguments);this._style=a.evalCss([".eruda-dev-tools .eruda-tools .eruda-memory {padding: 10px !important;}","canvas {width: 100%; border: 1px solid var(--border);}",".eruda-not-supported {background: var(--console-error-background); color: var(--console-error-foreground); padding: 10px; border: 1px solid var(--console-error-border); text-align: center;}"].join(".eruda-dev-tools .eruda-tools .eruda-memory "));this._container=i;this._isRunning=false;this._beginTime=a.now();this._prevTime=this._beginTime;this._frames=0;this._min=Infinity;this._max=0;this._alwaysActivated=true;this._appendTpl();this._initCanvas();this._initCfg()},show:function(){this._start();this.callSuper(n,"show",arguments)},hide:function(){if(!this._alwaysActivated)this._stop();this.callSuper(n,"hide",arguments)},destroy:function(){this._stop();a.evalCss.remove(this._style);this.callSuper(n,"destroy",arguments);this._rmCfg()},_rmCfg:function(){var t=this.config;var i=this._container.get("settings");if(!i)return;i.remove(t,"alwaysActivated").remove("Memory")},_start:function(){var t=performance.memory;if(!t){this._$el.html('<div class="eruda-not-supported">Not supported for this browser!</div>');return}if(this._isRunning)return;var i=this;this._isRunning=true;function e(){if(!i._isRunning)return;i._update();requestAnimationFrame(e)}e()},_stop:function(){this._isRunning=false;this._beginTime=a.now();this._prevTime=this._beginTime;this._frames=0},_appendTpl:function(){this._$el.html("<canvas></canvas>");this._canvas=this._$el.find("canvas").get(0);this._ctx=this._canvas.getContext("2d")},_initCanvas:function(){var t=this._canvas,i=this._ctx;t.width=r;t.height=e;i.font="bold 18px Helvetica,Arial,sans-serif";i.textBaseline="top";i.fillStyle=m;i.fillRect(0,0,r,e);i.fillStyle=p;i.fillText(_,o,l);i.fillRect(h,c,d,f);i.fillStyle=m;i.globalAlpha=.9;i.fillRect(h,c,d,f)},_initCfg:function(){var t=this._container;var i=this.config=s.createCfg("eruda-memory",{alwaysActivated:true});if(!i.get("alwaysActivated"))this._alwaysActivated=false;var e=this;i.on("change",function(t,i){switch(t){case"alwaysActivated":e._alwaysActivated=i;return}});var a=t.get("settings");a.text("Memory").switch(i,"alwaysActivated","Always Activated").separator()},_update:function(){this._frames++;var t=this._prevTime,i=a.now();if(i>t+1e3){var e=performance.memory;this._draw(e.usedJSHeapSize/1048576,e.totalJSHeapSize/1048576);this._prevTime=i;this._frames=0}this._beginTime=i},_draw:function(t,i){this._min=Math.min(this._min,t);this._max=Math.max(this._max,t);var e=this._min,a=this._max,s=this._canvas,n=this._ctx;n.fillStyle=m;n.globalAlpha=1;n.fillRect(0,0,r,c);n.fillStyle=p;n.fillText(v(t)+""+_+" ("+v(e)+"-"+v(a)+")",o,l);n.drawImage(s,h+u,c,d-u,f,h,c,d-u,f);n.fillRect(h+d-u,c,u,f);n.fillStyle=m;n.globalAlpha=.9;n.fillRect(h+d-u,c,u,v((1-t/i)*f))}});return new g}});